# DRFChatService

## 0. Chat Service ê°œìš”


- ì‚¬ìš©ìê°€ ì˜ì–´ íšŒí™” ë° ì¸í„°ë·°ë¥¼ ì—°ìŠµí•  ìˆ˜ ìˆëŠ” í”Œë«í¼

- í•´ì™¸ ì·¨ì—…ì„ ìƒê° í•˜ê±°ë‚˜ ì˜ì–´ ìŠ¤í”¼í‚¹ ì‹¤ë ¥ì„ ê¸°ë¥´ê³  ì‹¶ì€ ì‚¬ëŒì„ ìœ„í•œ í”Œë«í¼


## 1. ëª©í‘œì™€ ê¸°ëŠ¥
### 1.1 ëª©í‘œ

- í”„ë¡ íŠ¸ í”„ë¡œì íŠ¸ í™•ì¥ ê¸°ëŠ¥: OpenAIì˜ GPT-3.5 ëª¨ë¸ì„ ì´ìš©í•œ ì±—ë´‡ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œ

  
- API ê¸°ëŠ¥: ê¸°ì¡´ OpenAIì—ì„œ ì œê³µí•˜ëŠ” API ëŒ€ì‹  ì§ì ‘ êµ¬ì¶•í•œ ì„œë²„(DRF:Dangro Rest Framework)ë¥¼ í†µí•´ ìš”ì²­

  
- AI í†µí•© ê¸°ëŠ¥ : HTML/CSS í”„ë¡œì íŠ¸ì— AI ëŒ“ê¸€ ë° ë‹µë³€ ê¸°ëŠ¥ í†µí•©


- í”„ë¡ íŠ¸ì™€ ë°±ì•¤ë“œ ë¶„ë¦¬ : JSë¥¼ í™œìš©í•œ ë°±ì•¤ë“œ í†µì‹ 

  
### 1.2 ê¸°ëŠ¥
- DRF í™œìš©: ëª¨ë“  êµ¬í˜„ì€ Django Rest Frameworkë¥¼ ì‚¬ìš©í•˜ì—¬ ì§„í–‰


- ì‚¬ìš©ì ì¸ì¦: JWTë¥¼ í™œìš©í•œ íšŒì›ê°€ì… ë° ë¡œê·¸ì¸ ê¸°ëŠ¥ êµ¬í˜„


- ì±—ë´‡ API: Django ì„œë²„ ë‚´ ChatGPT API êµ¬í˜„


- ì‚¬ìš© ì œí•œ: ê° ì‚¬ìš©ìëŠ” í•˜ë£¨ì— ìµœëŒ€ 5ë²ˆ ìš”ì²­ ê°€ëŠ¥


- ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬: ì±„íŒ… ë‚´ì—­ ì €ì¥ ë° ì¡°íšŒ ê¸°ëŠ¥



## 2. ê°œë°œ í™˜ê²½ ë° ë°°í¬ URL
### 2.1 ê°œë°œ í™˜ê²½
- FE:


![HTML5](https://img.shields.io/badge/HTML5-E34F26.svg?style=flat&logo=html5&logoColor=white)
![CSS3](https://img.shields.io/badge/CSS3-1572B6.svg?style=flat&logo=css3&logoColor=white)
![JavaScript](https://img.shields.io/badge/JavaScript-F7DF1E.svg?style=flat&logo=javascript&logoColor=black)

- BE:


![Python](https://img.shields.io/badge/Python-3.8-3776AB.svg)
![Django](https://img.shields.io/badge/Django-3.x-092E20.svg)


- Deployment:

  
![AWS EC2](https://img.shields.io/badge/AWS-EC2-orange?style=flat&logo=amazonaws)
![Gunicorn](https://img.shields.io/badge/gunicorn-%2023.0-green.svg)
![Nginx](https://img.shields.io/badge/nginx-1.21.3-blue.svg?style=flat&logo=nginx&logoColor=white)


### 2.2 ë°°í¬ URL
https://www.studyin.co.kr/


## 3. ìš”êµ¬ì‚¬í•­ ëª…ì„¸ì™€ ê¸°ëŠ¥ ëª…ì„¸
![0](https://github.com/maxkim77/DRFChatService/assets/141907655/650c9dd6-d2e2-491a-8f7e-f56b5815c874)
### 3.1 ê¸°ë³¸ ìš”êµ¬ì‚¬í•­
- DRF í™œìš©: ëª¨ë“  êµ¬í˜„ì€ Django Rest Frameworkë¥¼ ì‚¬ìš©í•˜ì—¬ ì§„í–‰


- ì‚¬ìš©ì ì¸ì¦: íšŒì›ê°€ì… ë° ë¡œê·¸ì¸ ê¸°ëŠ¥ êµ¬í˜„


- ì±—ë´‡ API: Django ì„œë²„ ë‚´ ChatGPT API êµ¬í˜„


- ì‚¬ìš© ì œí•œ: ê° ì‚¬ìš©ìëŠ” í•˜ë£¨ì— ìµœëŒ€ 5ë²ˆ ìš”ì²­ ê°€ëŠ¥


- ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬: ì±„íŒ… ë‚´ì—­ ì €ì¥ ë° ì¡°íšŒ ê¸°ëŠ¥


### 3.2 ì„ íƒ ìš”êµ¬ì‚¬í•­
- ë„ë©”ì¸ ë° ë°°í¬: ê°œì¸ ë„ë©”ì¸ ë“±ë¡ ë° HTTPS ì ìš©


- OAuth2 ì—°ë™: ì¹´ì¹´ì˜¤, GitHub ë“± OAuth2 ì—°ê²°


## 4. ê°œë°œ ì¼ì • ë° í”„ë¡œì íŠ¸êµ¬ì¡° / í”Œë¡œìš° ì°¨íŠ¸
### 4.1 ê°œë°œì¼ì •(WBS)


![Untitled diagram-2023-11-21-043933](https://github.com/maxkim77/DRFChatService/assets/141907655/f8895ba5-8142-49d9-a08f-e3f95b6ff341)


| Scope              | WBS Level | WBS ID | WBS Element Title      | Completion  |
|--------------------|-----------|--------|------------------------|-------------|
| Planning           | 1         | plan1  | WBS, Model, Requirements|  |
| Planning           | 1         | plan2  | ERD                    |   |
| Design             | 2         | des1   | Screen Design          |   |
| Design             | 2         | des2   | URL Design             |   |
| Development        | 3         | dev1   | Page Implementation    |   |
| Development        | 3         | dev2   | CRUD Implementation    |   |
| Development        | 3         | dev3   | User Registration & Login |  |
| Development        | 3         | dev4   | Unique User Permissions |  |
| Development        | 3         | dev5   | ChatGPT Integration    |  |
| UI/UX              | 4         | ui1    | UI Implementation      |  |
| Deployment         | 5         | dep1   | Deployment             |  |
| Final Preparations | 6         | prep1  | Readme Completion      |  |
| Final Preparations | 6         | prep2  | Presentation Preparation|  |
| Presentation       | 7         | pres1  | Final Presentation     |  |

### 4.2 í”„ë¡œì íŠ¸ êµ¬ì¡°


### 4.3 í”Œë¡œìš° ì°¨íŠ¸
![ì œëª© ì—†ëŠ” ë‹¤ì´ì–´ê·¸ë¨ drawio](https://github.com/maxkim77/DRFChatService/assets/141907655/f4b4ebc5-e11d-4a51-ab4f-67155312c625)

### 4.4 URL ê¸°íš
| ì—”ë“œí¬ì¸íŠ¸          | HTTP ë©”ì„œë“œ | ê¸°ëŠ¥                            | ì•±          |
|----------------------|-------------|---------------------------------|-------------|
| `/admin/`            | GET         | ê´€ë¦¬ì íŒ¨ë„ ì ‘ì†                 | admin       |
| `/accounts/join/`    | POST        | ì‚¬ìš©ì ë“±ë¡                     | accounts    |
| `/accounts/mypage/`  | GET         | ë‚´ ì •ë³´ í˜ì´ì§€ ì¡°íšŒ              | accounts    |
| `/accounts/token/`    | POST        | JWT í† í° íšë“                   | accounts    |
| `/accounts/token/refresh/` | POST | JWT í† í° ê°±ì‹                    | accounts    |
| `/chatbot/chats/`    | GET         | ëª¨ë“  ì±„íŒ… ëª©ë¡ ì¡°íšŒ             | chatbot     |
| `/chatbot/chats/`    | POST        | ì±„íŒ… ìƒì„±                       | chatbot     |
| `/chatbot/chats/{id}/` | GET      | íŠ¹ì • ì±„íŒ… ì¡°íšŒ                   | chatbot     |
| `/chatbot/chats/{id}/` | PUT      | íŠ¹ì • ì±„íŒ… ìˆ˜ì •                   | chatbot     |
| `/chatbot/chats/{id}/` | DELETE   | íŠ¹ì • ì±„íŒ… ì‚­ì œ                   | chatbot     |



### 4.5 ì„¤ì¹˜ ë¼ì´ë¸ŒëŸ¬ë¦¬
```
aiohttp==3.8.5
aiosignal==1.3.1
asgiref==3.7.2
async-timeout==4.0.2
attrs==23.1.0
certifi==2023.7.22
charset-normalizer==3.2.0
click==8.1.6
Django==4.2.3
django-cors-headers==4.2.0
django-environ==0.10.0
djangorestframework==3.14.0
frozenlist==1.4.0
gTTS==2.3.2
idna==3.4
multidict==6.0.4
openai==0.27.8
pytz==2023.3
requests==2.31.0
sqlparse==0.4.4
tqdm==4.65.0
urllib3==2.0.4
yarl==1.9.2
djangorestframework-simplejwt==4.6
Djoser==2.1
django-allauth==0.49.0  # Adjust the version as needed
dj-rest-auth==2.2.5  # Adjust the version as needed
```


## 5. ì—­í•  ë¶„ë‹´: ê¹€ì •ì› Back-End Developer


## 6. ì™€ì´ì–´í”„ë ˆì„ / UI
![1](https://github.com/maxkim77/DRFChatService_BE/assets/141907655/d128d630-e9d2-4076-a28a-cb413e3d22a9)
![2](https://github.com/maxkim77/DRFChatService_BE/assets/141907655/190b0ea7-37d3-46a5-93f7-d7ed391b77ed)

## 7. ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸ë§:


![Untitled (1)](https://github.com/maxkim77/DRFChatService_BE/assets/141907655/08e230ca-6fa1-4fc0-a460-766f54af200a)

## 8. ì•„í‚¤í…ì²˜: ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ì„¤ê³„
## 9. ë©”ì¸ ê¸°ëŠ¥: ì£¼ìš” ê¸°ëŠ¥ ë° ì‘ë™ ë°©ì‹
- ì£¼ìš” í˜ì´ì§€ êµ¬í˜„

  
![10](https://github.com/maxkim77/DRFChatService/assets/141907655/c1e5f843-451c-45a8-b179-9ae48b437d19)


- Signup ê¸°ëŠ¥

  
![3](https://github.com/maxkim77/DRFChatService/assets/141907655/d40ff50c-ac3b-4142-b5eb-0a4307a15776)

  
- Login ê¸°ëŠ¥


![1](https://github.com/maxkim77/DRFChatService/assets/141907655/b71ca5a5-da7b-4bad-b71a-a0c3f87c5a6a)


- Logout ê¸°ëŠ¥


![4](https://github.com/maxkim77/DRFChatService/assets/141907655/ea879056-399d-468b-b547-9dcbefd73c71)


- Chat Gpt - DRF ì—°ê²°


https://github.com/maxkim77/DRFChatService/assets/141907655/0bcc53bf-03ce-4ede-84f6-b13ddd8a12c2


- ë¡œê·¸ì¸ì„ í•œ ìœ ì €ë§Œ ì‚¬ìš©ê°€ëŠ¥


![1](https://github.com/maxkim77/DRFChatService/assets/141907655/4692f2f4-351a-4ca3-ab58-b8128ad12bc2)


- ê° ìœ ì €ë‹¹ 5ë²ˆ ìš”ì²­ ì œí•œ

![ezgif com-resize](https://github.com/maxkim77/DRFChatService/assets/141907655/71e00498-098a-4871-918c-d5daa8637d54)


- ì±„íŒ…ë‚´ì—­ ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥ ì¬ë¡œê·¸ì¸í›„ ì¡°íšŒ ê°€ëŠ¥


![ezgif com-resize (1)](https://github.com/maxkim77/DRFChatService/assets/141907655/976f44c7-4f42-4b21-ae66-8a51aa77d507)


## ğŸ“œ10. ì—ëŸ¬ ë° í•´ê²°: ê°œë°œ ì¤‘ ë°œìƒí•œ ì£¼ìš” ë¬¸ì œ ë° í•´ê²° ë°©ë²•
**âš’ ì˜¤ë¥˜ 1: "400 (Bad Request)" ì˜¤ë¥˜ ë°œìƒ**

  - **ì›ì¸:** í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œ ê°„ì˜ ë°ì´í„° ë¶ˆì¼ì¹˜

  - **í•´ê²°ì±…:**

    - **í”„ë¡ íŠ¸ì—”ë“œ ìˆ˜ì •:**
    
        í•„ìˆ˜ í•„ë“œì™€ ë°ì´í„° í˜•ì‹ í™•ì¸ í›„ ì „ì†¡
        ```javascript
        fetch('http://127.0.0.1:8000/api/user/register/', {
          method: 'POST',
          mode: 'cors', 
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            username: username,
            email: email,
            password: password,
            password2: confirmPassword
          })
        })
        ```
    
    - **ì˜¤ë¥˜ ë©”ì‹œì§€ ì²˜ë¦¬:** í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì˜¤ë¥˜ ë©”ì‹œì§€ ì²˜ë¦¬

    - **ì„œë²„ ë¡œê·¸ ì •ìƒì‘ë™ í™•ì¸:**

**âš’ ì˜¤ë¥˜ 2: AssertionError in Allauth**
   - ì‚¬ìš©ì ì¸ì¦, ë“±ë¡, ë¡œê·¸ì¸, ë¹„ë°€ë²ˆí˜¸ ê¸°ëŠ¥ë“± ì œëŒ€ë¡œ ë™ì‘ í•˜ì§€ ì•Šì„ ë•Œ ë°œìƒí•˜ëŠ” ì—ëŸ¬ ë„¤ì„

  - **ì›ì¸:** ACCOUNT_USERNAME_REQUIRED ì„¤ì •ì´ Falseë¡œ ë˜ì–´ ìˆìŒ

  - **í•´ê²°ì±…:** `settings.py`ì—ì„œ `ACCOUNT_USERNAME_REQUIRED`ë¥¼ Trueë¡œ ì„¤ì •

**âš’ ì˜¤ë¥˜ 3: í† í° ì €ì¥ ë° ì‚¬ìš© ì˜¤ë¥˜**
  - ì¼ë°˜ token ì¸ì¦ êµ¬í˜„ì‹œ ë°œìƒí•œ ì˜¤ë¥˜
  - **í•´ê²°ì±…:**

    - **í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ ìˆ˜ì •:**
    
        í† í° í‚¤ ì¼ì¹˜ í™•ì¸
        ```javascript
        localStorage.setItem('token', data.Token);
        ```

    - **API í˜¸ì¶œ ì‹œ í† í° í¬í•¨:**
    
        Authorization í—¤ë”ì— í† í° ì¶”ê°€
        ```javascript
        headers: {
            'Content-Type': 'application/json',
            'Authorization': `Token ${localStorage.getItem('token')}`
        }
        ```


 **âš’ ì˜¤ë¥˜ 4: UNIQUE constraint failed: authtoken_token.user_id**
  - ì¼ë°˜ token êµ¬í˜„ì‹œ ë°œìƒí•œ ì˜¤ë¥˜
  - **í•´ê²°ì±…:**

  
     ì´ë¯¸ ìƒì„±ëœ í† í°ì„ ë°˜í™˜í•˜ê³  ê¸°ì¡´ í† í° ì‚­ì œ í›„ ìƒˆ í† í° ìƒì„±

 **ğŸ’¡ ì•Œê²Œëœ ì :**

  - í† í° ê´€ë ¨ ì˜¤ë¥˜ í•´ê²° ë°©ë²• ë° í† í° ê´€ë¦¬ ë°©ì‹ì˜ ì°¨ì´(JWT vs. Token Authentication)ë¥¼ ì•Œê²Œë¨.

- **Jwt Authentication in Views**

  - **ì„¤ì •:** `rest_framework_simplejwt.authentication.JWTAuthentication`ì„ `authentication_classes`ì— ì¶”ê°€

  - **ì‚¬ìš© ì˜ˆì‹œ:**
  ```python
  from rest_framework_simplejwt.authentication import JWTAuthentication
  from rest_framework.permissions import IsAuthenticated
  from rest_framework.views import APIView

  class ExampleView(APIView):
      authentication_classes = [JWTAuthentication]
      permission_classes = [IsAuthenticated]

      def get(self, request):
          # ì¸ì¦ëœ ì‚¬ìš©ìì˜ ì •ë³´ëŠ” `request.user`ë¥¼ í†µí•´ ì ‘ê·¼
          pass

- **Token Authentication in Views**

- **ì„¤ì •**: rest_framework.authentication.TokenAuthenticationì„ authentication_classesì— ì¶”ê°€

- **ì‚¬ìš© ì˜ˆì‹œ**:

```python
from rest_framework.authentication import TokenAuthentication
from rest_framework.permissions import IsAuthenticated
from rest_framework.views import APIView

class ExampleView(APIView):
    authentication_classes = [TokenAuthentication]
    permission_classes = [IsAuthenticated]

    def get(self, request):
        # ì¸ì¦ëœ ì‚¬ìš©ìì˜ ì •ë³´ëŠ” request.userë¥¼ í†µí•´ ì ‘ê·¼
        pass
```

##  ğŸ“–11. ê°œë°œí•˜ë©° ëŠë‚€ì : í”„ë¡œì íŠ¸ë¥¼ í†µí•´ ì–»ì€ ê²½í—˜ ë° ëŠë‚€ ì 
- DRFì±…ì„ ì§‘í•„í•˜ë©´ì„œ ê°œë…ë§Œ ê³µë¶€ë¥¼ í–ˆëŠ”ë°, ì‹¤ì œë¡œ ì ìš©í•´ë³´ë‹ˆ ë‹¨ìˆœí•´ë³´ì´ë©´ì„œë„ ë§¤ìš° ì–´ë µê²Œ ëŠë‚Œ
- íŠ¹íˆ ì¼ë°˜í† í°ì„ í†µí•´ êµ¬í˜„ì„ ë§ˆì³¤ì§€ë§Œ, JWTí† í°ë„ í•œë²ˆ ë„ì „í•´ë´ì•¼ê² ë‹¤ëŠ” ìƒê°ì— WBS ê³„íšë³´ë‹¤ ê¸°ê°„ì„ ëŠ˜ë ¤ 6ë²ˆì˜ í”„ë¡œì íŠ¸ ì¬ìƒì„±ì„ ëì— í†µì‹ ì— ì„±ê³µí•¨
- ë°±ì—”ë“œ ê°œë°œìë¡œ ê³µë¶€ë¥¼ í•˜ê³  ìˆì§€ë§Œ, í”„ë¡ íŠ¸ê°œë°œìì™€ ì†Œí†µí•˜ê±°ë‚˜ ì˜¤ë¥˜ë¥¼ í•´ê²°í•˜ë ¤ë©´ Js ì§€ì‹ë„ ê°–ì¶°ì•¼ í•¨ì„ ëŠë‚Œ ì¶”ê°€ì ìœ¼ë¡œ Vanilla Js ë§ê³ ë„ React ë“± ë‹¤ì–‘í•œ ê³µë¶€ë¥¼ í•´ì•¼ê² ë‹¤ëŠ” ìƒê°ì´ ë“¬
- DRFë¥¼ í•˜ë©° ì–´ë ¤ì› ë˜ ì : ìƒê°ë³´ë‹¤ ì°¸ê³ í•  ë§Œí•œ ê°•ì˜ë‚˜ ì˜ìƒì´ ì ì—ˆë˜ ì .  ì°¾ì•„ë³´ë©´ ë¸”ë¡œê·¸ ê¸€ì´ ìˆê¸´í•œë° ì—ëŸ¬ ìƒí™©ì´ ë‹¬ë¼ ì ìš©í•  ìˆ˜ ì—†ì—ˆë˜ì . ì˜ì–´ë¡œ ëœ ê°•ì˜ë‚˜ ë¬¸ì„œê°€ ë§ì•˜ë˜ ì . DRFëŠ” GPTì˜ í• ë£¨ì‹œë„¤ì´ì…˜ì´ ì¡°ê¸ˆ ì‹¬í–ˆë˜ ì 
- í•˜ì§€ë§Œ ì–´ë ¤ìš´ ë§Œí¼ DRFëŠ” í¬ì†Œì„± ìˆê³  ê²½ìŸë ¥ ìˆëŠ” ê¸°ìˆ ì´ë¼ëŠ” ìƒê°ì´ ë“¬
- ì„œë²„ ë°°í¬ë¥¼ í•˜ë©° ì–´ë ¤ì› ë˜ ì : ë§ˆì°¬ê°€ì§€ë¡œ ê´€ë ¨ í•œêµ­ì–´ ê°•ì˜ ë“±ì´ ì ì–´ ì ìš©í•˜ê¸° ì–´ë ¤ì› ìŒ. ê¸€ë§Œ ë³´ê³  ì´í•´í•˜ê¸° ë¶€ì¡±í•˜ë‹¤ëŠ” ëŠë‚Œì´ ë“¬.
- ì‹¤ì œ ë°±ì—”ë“œ ë°°í¬ë¥¼ AWSlightsail Ubuntu, Gunicorn, Nginx ë“±ì„ í†µí•´ í•´ë³´ë‹ˆ ì„œë²„ê´€ë ¨ ê° ìŠ¤íƒë“¤ì— ëŒ€í•´ ê°œëµì ì¸ ëŠë‚Œì„ ìµí ìˆ˜ ìˆì—ˆìŒ
  
##  ğŸ‘¦12. ë°±ì—”ë“œ ê°œë°œì : ê¹€ì •ì› Back-End Developer

